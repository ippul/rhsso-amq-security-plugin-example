apiVersion: keycloak.org/v1alpha1
kind: KeycloakClient
metadata:
  name: amq-broker
  labels:
    app: sso
spec:
  serviceAccountClientRoles:
    amq-broker:
      - uma_protection
  client:
    defaultClientScopes:
    - email
    - profile
    - roles
    - web-origins
    optionalClientScopes:
    - address
    - microprofile-jwt
    - offline_access
    - phone
    enabled: true
    clientAuthenticatorType: client-secret
    clientId: amq-broker
    name: amq-broker
    publicClient: false
    authorizationServicesEnabled: true
    authorizationSettings:
      allowRemoteResourceManagement: true
      resources:
        - attributes:
            deleteDurableQueue:
              "admin,queue1_admin"
            manage:
              "admin,queue1_admin"
            createNonDurableQueue:
              "admin,queue1_admin"
            send:
              "admin,queue1_admin"
            deleteAddress:
              "admin,queue1_admin"
            browse:
              "admin,queue1_admin"
            createDurableQueue:
              "admin,queue1_admin"
            deleteNonDurableQueue:
              "admin,queue1_admin"
            createAddress:
              "admin,queue1_admin"
            consume:
              "admin,queue1_admin"
          displayName: jms.queue.queue1
          name: jms.queue.queue1
          ownerManagedAccess: false
          type: AMQ_DESTINATION
        - attributes:
            deleteDurableQueue:
              "admin,queue2_admin"
            manage:
              "admin,queue2_admin"
            createNonDurableQueue:
              "admin,queue2_admin"
            send:
              "admin,queue2_admin"
            deleteAddress:
              "admin,queue2_admin"
            browse:
              "admin,queue2_admin"
            createDurableQueue:
              "admin,queue2_admin"
            deleteNonDurableQueue:
              "admin,queue2_admin"
            createAddress:
              "admin,queue2_admin"
            consume:
              "admin,queue2_admin"
          displayName: jms.queue.queue2
          name: jms.queue.queue2
          ownerManagedAccess: false
          type: AMQ_DESTINATION
    directAccessGrantsEnabled: true
    protocol: "openid-connect"
    serviceAccountsEnabled: true
    standardFlowEnabled: false
    secret: 4393af74-52c9-11ec-bf63-0242ac130002
  roles:
    - name: queue1_admin
    - name: queue2_admin
  realmSelector:
     matchLabels:
      realm: amq-sso-realm
---
apiVersion: keycloak.org/v1alpha1
kind: KeycloakClient
metadata:
  name: amq-console
  labels:
    app: sso
spec:
  client:
    enabled: true
    redirectUris:
      - 'http://ex-aao-wconsj-0-svc-rte-{{ .Release.Namespace }}.apps-crc.testing/*'
    clientId: amq-console
    name: amq-console
    protocol: openid-connect
    publicClient: true
    standardFlowEnabled: true
    directAccessGrantsEnabled: false
    serviceAccountsEnabled: false
    webOrigins:
      - '+'
    defaultRoles:
      - console_admin
    defaultClientScopes:
      - acr
      - email
      - profile
      - roles
      - web-origins
    optionalClientScopes:
      - address
      - microprofile-jwt
      - offline_access
      - phone
  realmSelector:
    matchLabels:
      app: sso
  roles:
    - name: console_admin
  scopeMappings: {}
